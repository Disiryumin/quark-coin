<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tapalka Clicker</title>
  <style>
    body {
    margin: 0;
    padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
    overflow: hidden;
    background: black;
    color: white;
    font-family: 'Space Mono', monospace;
    display: flex;
    flex-direction: column;
    align-items: center;
    height: 100vh;
}


    /* Твой стиль для вкладки Tasks */
    #tasksTab .centered-text {
      position: absolute;
      top: 50%; /* Центр по вертикали */
      left: 50%; /* Центр по горизонтали */
      transform: translate(-50%, -50%); /* Перемещение в точный центр */
      text-align: center;
    }

    .nav {
    position: fixed; /* Закрепляет панель внизу */
    bottom: 0; /* Располагает её у нижнего края */
    width: 100%; /* Растягивает панель по всей ширине */
    background: rgba(0, 0, 0, 0.8); /* Полупрозрачный фон (для видимости) */
    padding: 10px 0; /* Отступы для удобства */
    padding-bottom: calc(env(safe-area-inset-bottom) + 10px); /* Учитывает чёлку */
    display: flex; /* Центрирует содержимое */
    justify-content: center; /* Центрирует кнопки */
    z-index: 100; /* Устанавливает высокий приоритет отображения */
}

.nav span {
    font-size: 15px;
    margin: 0 10px;
    cursor: pointer;
    padding: 5px;
    color: gray;
    text-transform: capitalize;
}

.nav span:hover {
    color: white;
}

.nav span.active {
    text-decoration: none;
    font-weight: bold;
}

    .tab {
      display: none;
      flex-grow: 1;
      justify-content: center;
      align-items: center;
      text-align: center;
    }

    .tab.active {
      display: flex;
    }

    .tab h1 {
      font-size: 24px;
    }

    .ui {
      text-align: center;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: none;
      z-index: 1;
    }

    .ui .counter {
      font-size: 20px;
      margin-bottom: 12px;
    }

    .ui button {
      padding: 10px 20px;
      font-size: 14px;
      font-family: 'Space Mono', monospace;
      background-color: #444;
      border: none;
      border-radius: 5px;
      color: white;
      cursor: pointer;
    }

    .ui button:hover {
      background-color: #666;
    }

    /* Адаптация под мобильные устройства */
    @media (max-width: 768px) {
      .ui .counter {
        font-size: 18px;
      }

      .ui button {
        font-size: 14px;
        padding: 8px 16px;
      }

      .nav {
        font-size: 14px; /* Уменьшение размера текста */
        padding-bottom: calc(env(safe-area-inset-bottom) + 15px); /* Учитываем безопасную область */
    }

      .ui {
        top: 40%;
      }
    }
    /* Базовое состояние вкладок */
.nav span {
  font-size: 15px; /* На 3 единицы меньше */
  margin: 0 10px;
  cursor: pointer;
  padding: 5px;
  color: gray; /* Серый цвет для базового состояния */
  text-transform: capitalize; /* Первая буква заглавная */
}

/* Состояние при наведении */
.nav span:hover {
  color: white; /* Белый цвет при наведении */
}

    .nav span.active {
        text-decoration: none; /* Убираем подчеркивание */
  font-weight: bold; /* Можно добавить жирность для выделения */
}

    /* Секции вкладок */
    .tab {
      display: none;
      flex-grow: 1;
      justify-content: center;
      align-items: center;
      text-align: center;
    }

    .tab.active {
      display: flex;
    }

    .tab h1 {
      font-size: 24px;
    }

    /* UI для автофарминга */
    .ui {
  text-align: center;
  position: absolute; /* Позволяет позиционировать элемент в точной области экрана */
  top: 50%; /* Центр по вертикали */
  left: 50%; /* Центр по горизонтали */
  transform: translate(-50%, -50%); /* Перемещение в точный центр экрана */
  background: none; /* Убираем возможные лишние фоны */
  z-index: 1; /* Убедимся, что панель находится поверх сцены */
}

    .ui .counter {
      font-size: 20px;
      margin-bottom: 12px;
    }

    .ui button {
  padding: 10px 20px;
  font-size: 14px;
  font-family: 'Space Mono', monospace; /* Наш основной шрифт */
  background-color: #444;
  border: none;
  border-radius: 5px;
  color: white;
  cursor: pointer;
}

    .ui button:hover {
      background-color: #666;
    }
  </style>
</head>
<body>
  <!-- Вкладка Автофарминг -->
  <div id="farmingTab" class="tab active">
    <div class="ui">
      <div class="counter">QUARK: <span id="mainPoints">0</span></div>
      <div class="counter">farming: <span id="farmPoints">0</span></div>
      <button id="farmButton">start farming</button>
    </div>
  </div>

  <!-- Вкладка Мини-игра -->
  <div id="minigameTab" class="tab">
    <!-- Контент для вкладки "Mini-game" будет добавлен позже -->
  </div>

  <!-- Вкладка Задания -->
  <div id="tasksTab" class="tab">
    <div class="centered-text">
      <h1>Tasks</h1>
      <p>Pierce the overgrown piglet’s nipples twice with a stapler</p>
    </div>
  </div>

  <!-- Навигационная панель -->
  <div class="nav">
    <span id="farmingButton" class="active">Autofarming</span>
    <span id="minigameButton">Mini-game</span>
    <span id="tasksButton">Tasks</span>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/110/three.min.js"></script>
  <script>
    // Текущая вкладка
    let currentTab = 'farming';

    // Элементы вкладок
    const farmingTab = document.getElementById('farmingTab');
    const minigameTab = document.getElementById('minigameTab');
    const tasksTab = document.getElementById('tasksTab');

    // Кнопки навигации
    const farmingButton = document.getElementById('farmingButton');
    const minigameButton = document.getElementById('minigameButton');
    const tasksButton = document.getElementById('tasksButton');

    // Функция переключения вкладок
    function switchTab(tabName) {
      farmingTab.classList.remove('active');
      minigameTab.classList.remove('active');
      tasksTab.classList.remove('active');

      farmingButton.classList.remove('active');
      minigameButton.classList.remove('active');
      tasksButton.classList.remove('active');

      if (tabName === 'farming') {
        farmingTab.classList.add('active');
        farmingButton.classList.add('active');
      } else if (tabName === 'minigame') {
        minigameTab.classList.add('active');
        minigameButton.classList.add('active');
      } else if (tabName === 'tasks') {
        tasksTab.classList.add('active');
        tasksButton.classList.add('active');
      }
    }

    farmingButton.addEventListener('click', () => switchTab('farming'));
    minigameButton.addEventListener('click', () => switchTab('minigame'));
    tasksButton.addEventListener('click', () => switchTab('tasks'));

    // Логика фарминга
    let mainPoints = 0;
    let farmPoints = 0;
    let farmingActive = false;
    let farmingTimer;
    const farmingDuration = 60 * 1000; // 1 минута
    const farmIncrement = 0.0015; // Очки за 0.5 секунды

    const mainPointsDisplay = document.getElementById("mainPoints");
    const farmPointsDisplay = document.getElementById("farmPoints");
    const farmButton = document.getElementById("farmButton");

    function updatePoints() {
      farmPoints += farmIncrement;
      farmPointsDisplay.textContent = farmPoints.toFixed(4);
    }

    farmButton.addEventListener("click", () => {
      if (!farmingActive && farmButton.textContent === "start farming") {
        farmingActive = true;
        farmButton.textContent = "farming...";
        farmPoints = 0;
        farmPointsDisplay.textContent = farmPoints.toFixed(3);

        farmingTimer = setInterval(updatePoints, 500);

        setTimeout(() => {
          clearInterval(farmingTimer);
          farmingActive = false;
          farmButton.textContent = "claim";
        }, farmingDuration);
      } else if (farmButton.textContent === "claim") {
        mainPoints += farmPoints;
        farmPoints = 0;

        mainPointsDisplay.textContent = mainPoints.toFixed(3);
        farmPointsDisplay.textContent = farmPoints.toFixed(3);
        farmButton.textContent = "start farming";
      }
    });

    // Сцена, камера и рендерер
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer();
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    const starMaterial = new THREE.PointsMaterial({ color: 0xffffff, size: 1.5 });
    const starGeometry = new THREE.BufferGeometry();
    const starCount = 1000;
    const starPositions = new Float32Array(starCount * 3);

    for (let i = 0; i < starCount; i++) {
      const theta = Math.random() * 2 * Math.PI;
      const phi = Math.acos(2 * Math.random() - 1);
      const x = 500 * Math.sin(phi) * Math.cos(theta);
      const y = 500 * Math.sin(phi) * Math.sin(theta);
      const z = 500 * Math.cos(phi);

      starPositions[i * 3] = x;
      starPositions[i * 3 + 1] = y;
      starPositions[i * 3 + 2] = z;
    }

    starGeometry.setAttribute('position', new THREE.BufferAttribute(starPositions, 3));
    const stars = new THREE.Points(starGeometry, starMaterial);
    scene.add(stars);

    camera.position.z = 0;

    let isDragging = false;
let previousPosition = { x: 0, y: 0 };
let rotationX = 0;
let rotationY = 0;
let targetRotationX = 0;
let targetRotationY = 0;
let autoRotation = 0;

// Начало ввода (мышь или сенсор)
function startInput(clientX, clientY) {
  isDragging = true;
  previousPosition = { x: clientX, y: clientY };
}

// Обработка движения (мышь или сенсор)
function moveInput(clientX, clientY) {
  if (!isDragging) return;

  const deltaMove = {
    x: clientX - previousPosition.x,
    y: clientY - previousPosition.y,
  };

  const rotationSpeed = 0.005;

  targetRotationY += deltaMove.x * rotationSpeed;
  targetRotationX += deltaMove.y * rotationSpeed;

  previousPosition = { x: clientX, y: clientY };
}

// Завершение ввода (мышь или сенсор)
function endInput() {
  isDragging = false;
}

// Обработчики для мыши
document.addEventListener('mousedown', (event) => {
  startInput(event.clientX, event.clientY);
});

document.addEventListener('mousemove', (event) => {
  moveInput(event.clientX, event.clientY);
});

document.addEventListener('mouseup', () => {
  endInput();
});

// Обработчики для сенсора
document.addEventListener('touchstart', (event) => {
  const touch = event.touches[0]; // Первый палец
  startInput(touch.clientX, touch.clientY);
});

document.addEventListener('touchmove', (event) => {
  const touch = event.touches[0]; // Первый палец
  moveInput(touch.clientX, touch.clientY);
});

document.addEventListener('touchend', () => {
  endInput();
});

// Анимация
function animate() {
  autoRotation += 0.0005;

  rotationX += (targetRotationX - rotationX) * 0.1;
  rotationY += (targetRotationY - rotationY) * 0.1;

  // Вращение звёзд
  stars.rotation.x = rotationX;
  stars.rotation.y = autoRotation + rotationY;

  renderer.render(scene, camera);
  requestAnimationFrame(animate);
}

animate();

    // Обновление окна при изменении размера
    window.addEventListener('resize', () => {
      renderer.setSize(window.innerWidth, window.innerHeight);
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
    });
  </script>
</body>
</html>